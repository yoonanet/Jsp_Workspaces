<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<%-- 클라이언트가 페이지를 요청했을 때 한페이지를 담은 버퍼가 꽉차면 자동으로 서비스를 요청한 브라우저에 데이터를 전송해준다.
                                       out.wirte를 했을 때의 한줄의 텍스트들이 버퍼에 쌓였다가 전송이 되는 개념!!
          
     설정에 관련된 디렉티브는 페이지디렉티브로 다양한 속성을 제공해준다.
     => buffer와 autoFlush의 속성이 제공이 되고 있음. 이 속성이 지금 살펴보는 출력버퍼에 대한 설정을 셋팅해줄 수 있는 속성인 것이다. 
     buffer는 버퍼의 크기를 지정할 수 있는 none으로 주면 출력버퍼를 사용하지 않는 것임 (out.wirte할 때 실시간적으로 바로바로 전송을 해주는 것이다.)
              디폴트의 크기가 8kb인 것이다. => 쌓아두는 사이즈가 8kb인 것임
     autoFlush는 디폴트가 true, 버퍼의 내용이 꽉 차서 보내버리면 보내고 바로 버퍼의 내용을 깨끗하게 클리어시켜달라는 속성인 것이다.
                 false로 셋팅하면 버퍼의 내용이 꽉 찼을 때, 에러를 강제로 발생시키게끔 처리를 해주는 옵션이다.
       -> Flush라는 단어 채팅프로그램할 때, wirte한 후에 Flush를 해줬음. 
          버퍼가 꽉차야 네트워크로 데이터를 보내주는데 채팅 프로그램같은 경우 실시간적으로 데이터를 보내야하기 때문에
          현재 버퍼에 있는 내용들을 무조건적으로 보내달라는 기능이 flush인 것이다. --%>
<%@ page buffer="1kb" autoFlush="false" %> <%-- 버퍼에 1kb가 쌓이면 에러를 내주도록 설정하도록 한다. 동작이 제대로 되어지는지 보기 위함 --%>   
    
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>auto flush</title>
</head>
<body>

	<%-- 1234는 body영역에 구성되어있는 숫자일 뿐이다.
		 정수는 4byte할당이 되는데 이것을 보내기 전에 버퍼에 쌓음. 즉, 4바이트씩 쌓으면서 반복하도록 함.
		 250번정도 반복되면 1kb가 쌓일 것임
		 	          
		 컴퓨터의 속도가 느리면 1234가 먼저 전송이 됨. 나중에 에러메시지가 중간에 뜸 --%>
	<% for(int i = 0; i < 1000; i++) { %>
			1234 
	<%
		}	
	%>





<%-- [출력 버퍼와 응답]
	 출력버퍼 -> 세부적인 그림을 보면 웹콘테이너와 서블릿클래스 사이에 달려있는 것(2.2에 달려있는 것)
	             변환의 과정을 생략한 페이지로써 보여주고 있는 것임 -> 컴파일하여 실행되는 내용이라고 보면 되는 것이다.
	             (입출력 관련해서 채팅프로그램을 작성했을 때, 파일에 있는 데이터를 한바이트씩 복사하겠다고 한다면 1024를 한번에 읽어와서 전달하는 속도차이가 심했다.
	             즉, 버퍼가 장착되어져 있으면 한번에 버퍼에 장착해서 처리하는 것이 퍼포먼스 성능에 유리했음)
	             브라우저에서 한페이지를 텍스트 한 줄씩만 전송을 하게 되면 시간이 오래걸릴 것임. -> 퍼포먼스를 너무 잡아먹어서 버퍼가 필수적인 장착이 되어있어야 한다.
	             출력 결과를 출력버퍼에 쌓고, 버퍼가 차면 웹콘테이너에 한꺼번에 보내서 웹브라우저에는 한페이지로 보여지게 되는 것이다. 
	             
	             버퍼가 다 차기 전까지 헤더정보를 수정할 수 있음, 보내는 도중에 버퍼 비우고 내용전송 가능 
	             => 지금은 의미가 없음. 서버의 성능이 너무 좋아짐
	             
	             buffer크기는 어떻게 되고 우리가 제어할 수 있는 부분이 있는지 파악 --%>
</body>
</html>